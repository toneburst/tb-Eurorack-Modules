var valx=0,valy=0,autoresetindex=2,autoreset=resetperiodtable[autoresetindex][1],lnshiftchannel=0,thresholds=new Array;thresholds[0]=127,thresholds[1]=127,thresholds[2]=127,thresholds[3]=127;var stepvals=new Array;stepvals[0]=patterns[0][0][0][0],stepvals[1]=patterns[0][0][1][0],stepvals[2]=patterns[0][0][2][0],stepvals[3]=patterns[0][0][3][0],stepvals[4]=patterns[0][0][4][0],stepvals[5]=patterns[0][0][5][0];var channelstepcount=new Array;channelstepcount[0]=[16,0,0,0],channelstepcount[1]=[16,0,0,0],channelstepcount[2]=[16,0,0,0],channelstepcount[3]=[16,0,0,0];var randomtablecounter=0,randomtablerandomincrement=Math.round(31*Math.random()),slide=!1,bpm=120,ticker=new TBWMClock(bpm),clock=new TBMWClockdivider,masterstepcounter=0,midi_lowvelocity=63,midi_highvelocity=127,transpose=24,enablerecord=!1,recording=[],scaleindex=2,scale=mpscales[scaleindex][1],midi_previousnotes=[0],recorder=null,midiout=null,quantiser=null;$(document).ready(function(){setupcontrols(),quantiser=new TBWMNotequantiser,midiout=new TBMWMIDIio,midiout.init("#midi-outputsettings"),setupplaybackcontrols(),ticker.init({bpm:bpm,workerurl:"js/lib/tbwm-modules/tbwm-clock/clockworker.min.js"}).bind("tick",function(e){clock.tick()}),clock.init({autoreset:autoreset,counting:"continuous"});var e=0;clock.bind("1/32",function(t){0===e?(playStep(),recorder&&recorder.updateticks(),masterstepcounter++):(getStepVals(),recorder&&recorder.updateticks()),e=1-e})});