var valx=0;var valy=0;var autoresetindex=2;var autoreset=16;var lnshiftchannel=0;var thresholds=new Array();thresholds[0]=127;thresholds[1]=127;thresholds[2]=127;thresholds[3]=127;var stepvals=new Array();stepvals[0]=patterns[0][0][0][0];stepvals[1]=patterns[0][0][1][0];stepvals[2]=patterns[0][0][2][0];stepvals[3]=patterns[0][0][3][0];stepvals[4]=patterns[0][0][4][0];stepvals[5]=patterns[0][0][5][0];var channelstepcount=new Array();channelstepcount[0]=[16,0,0,0];channelstepcount[1]=[16,0,0,0];channelstepcount[2]=[16,0,0,0];channelstepcount[3]=[16,0,0,0];var randomtablecounter=0;var randomtablerandomincrement=Math.round(Math.random()*31);var slide=false;var bpm=120;var ticker=new TBWMClock(bpm);var clock=new TBMWClockdivider();var masterstepcounter=0;var midi_lowvelocity=63;var midi_highvelocity=127;var transpose=24;var enablerecord=false;var recording=[];var scaleindex=2;var scale=mpscales[scaleindex][1];var midi_previousnotes=[];var recorder=null;var midiout=null;var quantiser=null;$(document).ready(function(){setupcontrols();quantiser=new TBWMNotequantiser();midiout=new TBMWMIDIio();midiout.init("#midi-outputsettings");setupplaybackcontrols();clock.init({autoreset:autoreset,counting:"continuous"});ticker.init({bpm:bpm,workerurl:"js/lib/tbwm-modules/tbwm-clock/clockworker.min.js"}).bind("tick",function(b){clock.tick()});clock.bind("1/16",function(b){masterstepcounter=b});var a=0;clock.bind("1/32",function(b){if(a===0){playStep();if(recorder){recorder.updateticks()}}else{getStepVals();if(recorder){recorder.updateticks()}}a=1-a})});