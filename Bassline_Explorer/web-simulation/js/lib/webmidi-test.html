<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>WebMidi Test</title>
        <script src="webmidiapi/WebMIDIAPI.min.js" charset="utf-8"></script>
        <script src="webmidi/webmidi.js" charset="utf-8"></script>
        <script type="text/javascript">
            window.onload=function() {

                var m = null; // m = MIDIAccess object for you to make calls on
                navigator.requestMIDIAccess().then( onsuccesscallback, onerrorcallback );

                function onsuccesscallback( access ) {

                  m = access;

                  // Things you can do with the MIDIAccess object:
                 // var inputs = m.inputs; // inputs = MIDIInputMaps, you can retrieve the inputs with iterators
                  var outputs = m.outputs; // outputs = MIDIOutputMaps, you can retrieve the outputs with iterators

                  //var iteratorInputs = inputs.values() // returns an iterator that loops over all inputs
                  //var input = iteratorInputs.next().value // get the first input

                  //input.onmidimessage = myMIDIMessagehandler; // onmidimessage( event ), event.data & event.receivedTime are populated

                  //var iteratorOutputs = outputs.values() // returns an iterator that loops over all outputs
                  //var output = iteratorOutputs.next().value; // grab first output device

                  var ports = [];

                  m.outputs.forEach(function(port) {
                      ports.push(port.id);
                  });

                  var output = m.outputs.get(ports[0]);

                  output.open();

                  output.send( [ 0x90, 0x45, 0x7f ] ); // full velocity note on A4 on channel zero
                  output.send( [ 0x80, 0x45, 0x7f ], window.performance.now() + 1000 ); // full velocity A4 note off in one second.
                };

                function onerrorcallback( err ) {
                  console.log( "uh-oh! Something went wrong! Error code: " + err.code );
              };

            };
        </script>
    </head>
    <body>

    </body>
</html>
