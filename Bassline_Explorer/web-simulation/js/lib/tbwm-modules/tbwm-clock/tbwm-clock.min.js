function TBWMClock(t){this.tempo=t,this.audioContext=null,this.isPlaying=!1,this.startTime,this.lookahead=10,this.scheduleAheadTime=.1,this.nextTickTime=0,this.timerWorker=null,this.secondsPerTick=2.5/this.tempo,this.newTempo=this.tempo,this.workerurl=null}MicroEvent.mixin(TBWMClock),TBWMClock.prototype.setWorkerURL=function(t){this.workerurl=t},TBWMClock.prototype.setTempo=function(t){this.newTempo=t},TBWMClock.prototype.nextTick=function(){this.nextTickTime+=this.secondsPerTick,this.tempo!=this.newTempo&&(this.tempo=this.newTempo,this.secondsPerTick=2.5/this.tempo)},TBWMClock.prototype.scheduleTick=function(t){var e=this;e.trigger("tick","Tick!")},TBWMClock.prototype.scheduler=function(){for(;this.nextTickTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleTick(this.nextTickTime),this.nextTick()},TBWMClock.prototype.start=function(){this.nextTickTime=this.audioContext.currentTime,this.timerWorker.postMessage("start"),console.log("Starting 96ppqn Clock"),this.isPlaying=!0},TBWMClock.prototype.stop=function(){this.timerWorker.postMessage("stop"),console.log("Stopping 96ppqn Clock"),this.isPlaying=!1},TBWMClock.prototype.init=function(){var t=this;this.audioContext=new AudioContext;this.audioContext.createOscillator();this.timerWorker=new Worker(this.workerurl),this.timerWorker.addEventListener("message",function(e){"tick"==e.data?t.scheduler():console.log("message: "+e.data)},!1),this.timerWorker.postMessage({interval:this.lookahead})};