function TBWMClock(){this.tempo=120,this.audioContext=null,this.isplaying=!1,this.startTime,this.lookahead=10,this.scheduleAheadTime=.1,this.nextTickTime=0,this.timerWorker=null,this.secondsPerTick=2.5/this.tempo,this.newTempo=this.tempo,this.workerurl=null}MicroEvent.mixin(TBWMClock),TBWMClock.prototype.nextTick=function(){this.nextTickTime+=this.secondsPerTick,this.tempo!=this.newTempo&&(this.tempo=this.newTempo,this.secondsPerTick=2.5/this.tempo)},TBWMClock.prototype.scheduleTick=function(t){var e=this;e.trigger("tick","tick")},TBWMClock.prototype.scheduler=function(){for(;this.nextTickTime<this.audioContext.currentTime+this.scheduleAheadTime;)this.scheduleTick(this.nextTickTime),this.nextTick()},TBWMClock.prototype.settempo=function(t){return this.newTempo=t,this},TBWMClock.prototype.start=function(){return this.nextTickTime=this.audioContext.currentTime,this.timerWorker.postMessage("start"),console.log("Starting 24PPQN Clock"),this.isplaying=!0,this},TBWMClock.prototype.stop=function(){return this.timerWorker.postMessage("stop"),console.log("Stopping 24PPQN Clock"),this.isplaying=!1,this},TBWMClock.prototype.init=function(t){t.bpm&&(this.tempo=t.bpm),t.workerurl?this.workerurl=t.workerurl:console.log("Error: Webworker URL must be set relative to HTML page using <instance>.setworkerurl(<url>) method");var e=this;this.audioContext=new AudioContext;this.audioContext.createOscillator();return this.timerWorker=new Worker(this.workerurl),this.timerWorker.addEventListener("message",function(t){"tick"==t.data?e.scheduler():console.log("message: "+t.data)},!1),this.timerWorker.postMessage({interval:this.lookahead}),this};