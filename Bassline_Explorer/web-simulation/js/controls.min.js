function setupplaybackcontrols(){midiout.bind("midistatus",function(f){midiout.addoutputselect({savetocookie:false});midiout.addoutchannelselect({savetocookie:false});midiout.addtestbutton()});$lowvelocityslider=$("#slidermidilowvelocity");$lowvelocityslider.val(midi_lowvelocity);$lowvelocityslider.change(function(){midi_lowvelocity=parseInt($(this).val())});$highvelocityslider=$("#slidermidihighvelocity");$highvelocityslider.val(midi_highvelocity);$highvelocityslider.change(function(){midi_highvelocity=parseInt($(this).val())});quantiser.addscaleselect("#midi-scalesettings");quantiser.addtransposeselect("#midi-scalesettings");var a=$("#clock-autoreset");a.val(autoreset);a.change(function(){autoreset=parseInt($(this).val());clock.setautoreset(autoreset)});$("button#playbutton").click(function(){if(ticker.isplaying==false){ticker.start();$(this).text("Stop sequencer")}else{ticker.stop();clock.reset();$(this).text("Start sequencer")}});var c=$("#slider_tempo");c.val(bpm);c.on("change",function(){bpm=parseInt($(this).val());ticker.settempo(bpm)});var b=$("#midixmlformsubmit");var e=$("#recordbutton");e.data("recordstatus","0");b.hide();var d=null;e.mousedown(function(){if(e.data("recordstatus")==="0"){e.prop("disabled",true).html("Recording Armed");clock.bind("beforebar",function(){e.prop("disabled",false);e.html("Recording...");recorder=new MIDIXMLRecorder();recorder.settempo(bpm);recorder.startrecording();clock.unbind("beforebar")});e.data("recordstatus","1")}else{e.prop("disabled",true).html("Recording Disarmed");clock.bind("beforebar",function(){e.prop("disabled",false).html("Record");clock.unbind("beforebar");recorder.stoprecording();d=recorder.getmidixml();recorder=null;b.show()});e.data("recordstatus","0")}});b.mousedown(function(){if(d){var f=$.ajax({url:"php/ajax-submit-midixml.php",method:"POST",data:{mxml:d},dataType:"text"});f.done(function(g){if(g.substring(0,5)=="Error:"){console.log(g)}else{b.hide();$("#midifileiframe").attr("src",g)}});f.fail(function(g,h){alert("Request failed: "+h)})}})}function setupcontrols(){var k=75;var f=k;var i=["#ff0000","#ff00ff","#00ff00","#0000ff","#666"];var j=$("#knob_x");j.knob({width:k,height:k,fgColor:i[4],inputColor:i[4],lineCap:"round",change:function(l){valx=parseInt(l)}});j.val(valx).trigger("change");var h=$("#knob_y");h.knob({width:k,height:k,fgColor:i[4],inputColor:i[4],lineCap:"round",value:valy,change:function(l){valy=parseInt(l)}});h.val(valy).trigger("change");var c=$("#knob_threshold_note");c.knob({width:k,height:k,lineCap:"round",fgColor:i[0],inputColor:i[0],change:function(l){intval=parseInt(l);thresholds[0]=intval}});c.val(thresholds[0]).trigger("change");var b=$("#knob_threshold_octave");b.knob({width:k,height:k,lineCap:"round",fgColor:i[1],inputColor:i[1],change:function(l){intval=parseInt(l);thresholds[1]=intval}});b.val(thresholds[1]).trigger("change");var d=$("#knob_threshold_accent");d.knob({width:k,height:k,fgColor:i[2],inputColor:i[2],lineCap:"round",change:function(l){thresholds[2]=parseInt(l)}});d.val(thresholds[2]).trigger("change");var e=$("#knob_threshold_slide");e.knob({width:k,height:k,fgColor:i[3],inputColor:i[3],lineCap:"round",change:function(l){thresholds[3]=parseInt(l)}});e.val(thresholds[3]).trigger("change");var a=$("#knob_length");a.knob({width:k,height:k,fgColor:i[lnshiftchannel],inputColor:i[lnshiftchannel],lineCap:"round",change:function(l){channelstepcount[lnshiftchannel][0]=parseInt(l)}});a.val(channelstepcount[lnshiftchannel][0]).trigger("change");var g=$("#knob_shift");g.knob({width:k,height:k,fgColor:i[lnshiftchannel],inputColor:i[lnshiftchannel],lineCap:"round",change:function(l){channelstepcount[lnshiftchannel][1]=parseInt(l)}});g.val(channelstepcount[lnshiftchannel][1]).trigger("change");$("input[type='radio']").click(function(){var l=$("input[name='lnshft-function']:checked").val();if(l){lnshiftchannel=parseInt(l);a.val(channelstepcount[lnshiftchannel][0]).trigger("change");a.trigger("configure",{fgColor:i[lnshiftchannel],inputColor:i[lnshiftchannel]});g.val(channelstepcount[lnshiftchannel][1]).trigger("change");g.trigger("configure",{fgColor:i[lnshiftchannel],inputColor:i[lnshiftchannel]})}})};