function setupplaybackcontrols(){for(var n,e=/[?&]([^=#]+)=([^&#]*)/g,t=window.location.href,i={};n=e.exec(t);)i[n[1]]=n[2];midiout.bind("midistatus",function(n){midiout.addoutputselect({savetocookie:!1}),midiout.addoutchannelselect({savetocookie:!1}),midiout.addtestbutton()}),$lowvelocityslider=$("#slidermidilowvelocity"),$lowvelocityslider.val(midi_lowvelocity),$lowvelocityslider.change(function(){midi_lowvelocity=parseInt($(this).val())}),$highvelocityslider=$("#slidermidihighvelocity"),$highvelocityslider.val(midi_highvelocity),$highvelocityslider.change(function(){midi_highvelocity=parseInt($(this).val())}),quantiser.addscaleselect("#midi-scalesettings"),quantiser.addtransposeselect("#midi-scalesettings"),quantiser.addrandomrange("#midi-scalesettings"),$("button#playbutton").click(function(){0==ticker.isplaying?(ticker.start(),$(this).text("Stop sequencer")):(ticker.stop(),clock.reset(),$(this).text("Start sequencer"))});var o=$("#slider_tempo");o.val(bpm),o.on("change",function(){bpm=parseInt($(this).val()),ticker.settempo(bpm)});var r=$("#midixmlformsubmit"),l=$("#recordbutton");l.data("recordstatus","0"),l.mousedown(function(){"0"===l.data("recordstatus")?(l.prop("disabled",!0).html("Recording Armed"),clock.bind("beforebar",function(){l.prop("disabled",!1),l.html("Recording..."),r.hide(),recorder=new MIDIXMLRecorder,recorder.settempo(bpm),recorder.startrecording(),clock.unbind("beforebar")}),l.data("recordstatus","1")):(l.prop("disabled",!0).html("Recording Disarmed"),clock.bind("beforebar",function(){l.prop("disabled",!1).html("Record"),clock.unbind("beforebar"),recorder.stoprecording(),$("#midixmlformhidden").val(recorder.getmidixml()),$("#midixmlform").submit(),recorder=null}),l.data("recordstatus","0"))})}function setupcontrols(){var n=75,e=["#ff0000","#ff00ff","#00ff00","#0000ff","#666"],t=$("#knob_x");t.knob({width:n,height:n,fgColor:e[4],inputColor:e[4],lineCap:"round",change:function(n){valx=parseInt(n)}}),t.val(valx).trigger("change");var i=$("#knob_y");i.knob({width:n,height:n,fgColor:e[4],inputColor:e[4],lineCap:"round",value:valy,change:function(n){valy=parseInt(n)}}),i.val(valy).trigger("change");var o=$("#knob_threshold_note");o.knob({width:n,height:n,lineCap:"round",fgColor:e[0],inputColor:e[0],change:function(n){intval=parseInt(n),thresholds[0]=intval}}),o.val(thresholds[0]).trigger("change");var r=$("#knob_threshold_octave");r.knob({width:n,height:n,lineCap:"round",fgColor:e[1],inputColor:e[1],change:function(n){intval=parseInt(n),thresholds[1]=intval}}),r.val(thresholds[1]).trigger("change");var l=$("#knob_threshold_accent");l.knob({width:n,height:n,fgColor:e[2],inputColor:e[2],lineCap:"round",change:function(n){thresholds[2]=parseInt(n)}}),l.val(thresholds[2]).trigger("change");var a=$("#knob_threshold_slide");a.knob({width:n,height:n,fgColor:e[3],inputColor:e[3],lineCap:"round",change:function(n){thresholds[3]=parseInt(n)}}),a.val(thresholds[3]).trigger("change");var c=$("#knob_length");c.knob({width:n,height:n,fgColor:e[lnshiftchannel],inputColor:e[lnshiftchannel],lineCap:"round",change:function(n){channelstepcount[lnshiftchannel][0]=parseInt(n)}}),c.val(channelstepcount[lnshiftchannel][0]).trigger("change");var h=$("#knob_shift");h.knob({width:n,height:n,fgColor:e[lnshiftchannel],inputColor:e[lnshiftchannel],lineCap:"round",change:function(n){channelstepcount[lnshiftchannel][1]=parseInt(n)}}),h.val(channelstepcount[lnshiftchannel][1]).trigger("change"),$("input[type='radio']").click(function(){var n=$("input[name='lnshft-function']:checked").val();n&&(lnshiftchannel=parseInt(n),c.val(channelstepcount[lnshiftchannel][0]).trigger("change"),c.trigger("configure",{fgColor:e[lnshiftchannel],inputColor:e[lnshiftchannel]}),h.val(channelstepcount[lnshiftchannel][1]).trigger("change"),h.trigger("configure",{fgColor:e[lnshiftchannel],inputColor:e[lnshiftchannel]}))})}